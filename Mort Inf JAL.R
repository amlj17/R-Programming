#Andres Moguel
#Traemos los datos de Mortalidad Infantil de Jalisco
JAL2000<-c(25.71,21.41,23.05,28.17,25.32,24.55,24.17,25.10,22.51,31.89,33.14,25.46,25.02,27.45,22.30,26.91,25.94,
          23.26,38.34,35.22,26.00,23.50,20.78,24.25,24.75,26.32,37.67,28.31,29.00,21.06,39.85,30.93,25.96,
          25.88,25.93,23.29,22.96,29.51,18.06,28.37,25.76,31.94,27.95,22.58,27.87,23.83,22.31,28.32,36.25,
          24.13,21.73,26.45,24.75,23.15,23.25,37.78,25.16,23.98,24.70,27.98,49.62,28.06,19.72,29.05,24.87,25.81,
          21.17,31.81,31.25,22.60,29.07,29.51,23.97,23.20,27.77,30.10,22.18,24.21,26.57,30.84,29.01,23.74,22.73,29.12,
          24.59,29.62,25.51,24.43,25.74,25.80,27.36,27.51,22.30,24.87,24.58,27.35,22.98,21.03,32.17,27.05,
          23.02,25.66,25.07,28.02,25.47,32.03,25.19,23.91,28.11,22.77,25.22,25.00,27.96,23.68,33.98,23.99,
          27.83,24.80,24.64,19.86,25.22,32.63,29.77,26.32)
JAL2005<-c(25.83,14.88,17.16,25.23,20.31,17.74,24.86,22.48,17.82,33.29,32.58,25.27,22.40,32.73,15.67,25.82,24.25,18.56,57.93,29.15,21.31,19.99,12.74,20.87,19.16,26.80,49.16,21.88,27.85,15.09,38.46,32.88,23.63,27.35,25.62,17.59,17.38,34.15,6.97,27.43,19.71,35.34,22.22,18.48,26.68,21.30,14.78,29.56,31.79,21.88,15.86,27.69,22.33,17.94,19.68,36.99,24.46,17.66,21.56,21.94,76.66,24.47,15.13,32.02,21.45,25.39,10.80,37.16,34.86,17.23,26.89,28.5,21.38,16.85,25.75,34.08,16.05,20.46,26.51,27.53,32.07,17.27,18.46,28.82,22.55,33.53,23.51,22.15,23.04,19.28,24.42,29.61,16.65,22.48,22.67,23.61,15.85,12.79,36.89,26.23,15.09,19.82,20.70,21.33,21.77,34.02,26.07,20.29,29.87,14.07,17.78,25.77,30.60,21.21,33.70,20.90,21.83,24.13,23.38,8.40,17.93,35.47,22.47,23.02)
JAL2010<-c(10.16,11.18,14.98,9.46,11.43,11.02,11.91,20.35,8.75,15.60,10.25,11.74,15.01,23.64,15.62,16.20,16.13,11.60,38.19,15.61,14.00,15.70,12.86,18.86,10.71,9.88,26.10,10.54,11.14,9.87,14.27,10.96,11.23,9.49,17.88,14.65,12.00,12.42,11.35,13.27,9.43,20.05,10.04,13.07,10.38,10.46,9.31,14.49,15.39,14.89,8.64,11.54,14.22,8.68,11.18,28.42,20.46,12.64,18.03,10.68,56.70,10.23,11.91,18.09,10.53,18.44,13.14,11.54,15.10,13.41,10.65,14.04,13.08,18.04,18.12,16.25,11.71,22.14,9.90,29.49,14.26,9.11,12.25,11.62,9.45,25.05,15.56,15.40,9.56,25.85,15.65,14.88,12.20,13.68,13.19,13.88,14.90,13.84,11.33,10.84,12.98,10.92,16.58,19.69,15.73,14.93,13.98,15.64,13.41,15.35,11.39,14.25,15.40,26.52,29.76,13.65,11.90,17.29,9.71,12.66,10.81,11.22,9.89,12.42)

#Aplicamos una Prueba de Normalidad
#Ji Cuadrada
library(nortest)
z=pearson.test(JAL2000)
print(z$p.value)
w=pearson.test(JAL2005)
print(w$p.value)
y=pearson.test(JAL2010)
print(y$p.value)

#En los 3 casos se rechaza H0 y no hay normalidad
#Se utilizan pruebas no paramétricas
#una muestra, queremos comparar si
#a) Contraste de mediana para una muestra 
# H0: mediana de Jal igual a la mediana nacional en 2010 para mort infantil
# vs 
#H1: mediana de JAl diferente a la mediana nacional
#la mediana nacional es de 15.40 
wilcox.test(JAL2010, mu=15.40, alternative = "two.sided")
#P-VALOR ES menor a 0.05 entonces rechazamos h0 y concluimos que las medianas son distintas

#b) Contraste de medianas para dos muestras pareadas
#buscamos ver si la mediana de la mortalidad infantil ha disminiudo en 5 años
#h0 Mediana 2005 >= Mediana 2010 vs
#H1 Mediana 2005 < Mediana 2010
wilcox.test(JAL2005, JAL2010, paired = TRUE, alternative = "less")
#el P valor es igual a 1 por lo que no se rechaza H0 

#comparemos muestras no pareadas
#veamos el edo de Puebla del 2000
PUE2000<-c(27.57,36.66,25.25,27.85,43.40,45.08,37.81,29.05,29.02,36.83,29.04,29.27,27.51,40.10,23.75,33.81,34.00,32.47,23.97,28.40,29.46,34.89,34.86,28.87,33.65,30.68,36.38,47.60,38.25,34.25,34.82,35.89,33.32,27.24,29.40,44.40,28.87,28.07,40.99,33.50,20.83,31.59,36.44,29.78,27.23,28.70,26.75,26.15,44.31,41.71,28.62,33.06,29.88,31.83,32.45,32.96,32.31,38.58,30.34,27.30,56.82,31.57,27.72,35.53,31.40,33.06,29.26,45.17,32.76,36.35,26.86,47.79,28.42,23.90,33.41,36.38,55.56,41.23,27.20,37.19,35.69,27.30,35.16,47.75,24.75,39.22,33.39,41.81,44.25,25.63,22.56,40.37,32.78,27.60,27.74,27.98,25.59,31.53,35.31,38.19,33.23,26.38,33.37,27.83,31.08,35.48,46.46,26.12,34.56,32.57,40.89,29.52,30.44,18.86,32.29,39.03,23.18,27.10,24.34,39.67,37.98,25.14,47.01,29.83,25.59,31.41,33.50,29.63,31.69,28.55,29.22,21.31,27.98,25.50,32.18,20.83,31.53,30.56,32.73,21.75,29.54,28.32,25.57,27.59,46.22,33.51,33.16,35.18,30.28,36.82,27.27,28.77,27.66,26.55,29.80,22.37,29.57,37.70,41.94,30.78,29.34,42.79,24.30,25.94,42.27,31.05,44.08,38.01,30.93,30.81,24.69,36.02,22.27,22.90,30.89,28.51,32.85,39.82,30.56,27.40,24.70,30.66,41.89,47.43,32.39,30.56,39.10,32.38,30.62,29.02,30.68,33.61,36.22,32.12,45.01,28.91,29.03,34.54,32.86,33.62,33.49,39.35,35.14,30.26,29.43,35.25,32.04,28.11,35.09,34.49,23.63,37.04,41.00,29.24,32.50,40.09,46.80)
#checamos normalidad
d=pearson.test(PUE2000)
print(d$p.value)
#c) Contraste de medianas para dos muestras independientes (U de Mann–Whitney)
#Queremos comparar las medianas de mortalidad infantil de Puebla y de Jalisco en el año 2000
#H0: MeJAL-MePUE=3
#vs
#H1: MeJAL-MePUE<>3
wilcox.test(JAL2000, PUE2000, paired = FALSE, alternative = "two.sided",mu=3)
#el p valor es menor a alfa y por lo tanto se rechaza H0 
a=median(PUE2000)
b=median(JAL2000)
print(b-a)